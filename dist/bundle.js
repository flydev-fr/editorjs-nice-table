!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Table=t():e.Table=t()}(window,function(){return function(e){var t={};function l(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,l),i.l=!0,i.exports}return l.m=e,l.c=t,l.d=function(e,t,s){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(s,i,function(t){return e[t]}.bind(null,i));return s},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l(l.s=10)}([function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M11,2A2,2 0 0,1 13,4V20A2,2 0 0,1 11,22H2V2H11M4,10V14H11V10H4M4,16V20H11V16H4M4,4V8H11V4H4M15,11H18V8H20V11H23V13H20V16H18V13H15V11Z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M22,10A2,2 0 0,1 20,12H4A2,2 0 0,1 2,10V3H4V5H8V3H10V5H14V3H16V5H20V3H22V10M4,10H8V7H4V10M10,10H14V7H10V10M20,10V7H16V10H20M11,14H13V17H16V19H13V22H11V19H8V17H11V14Z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M6,5V5.18L8.82,8H11.22L10.5,9.68L12.6,11.78L14.21,8H20V5H6M3.27,5L2,6.27L8.97,13.24L6.5,19H9.5L11.07,15.34L16.73,21L18,19.73L3.55,5.27L3.27,5Z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M3,3H21V5H3V3M3,7H15V9H3V7M3,11H21V13H3V11M3,15H15V17H3V15M3,19H21V21H3V19Z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M3,3H21V5H3V3M7,7H17V9H7V7M3,11H21V13H3V11M7,15H17V17H7V15M3,19H21V21H3V19Z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M3,3H21V5H3V3M9,7H21V9H9V7M3,11H21V13H3V11M9,15H21V17H9V15M3,19H21V21H3V19Z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M13,2A2,2 0 0,0 11,4V20A2,2 0 0,0 13,22H22V2H13M20,10V14H13V10H20M20,16V20H13V16H20M20,4V8H13V4H20M9,11H6V8H4V11H1V13H4V16H6V13H9V11Z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M22,14A2,2 0 0,0 20,12H4A2,2 0 0,0 2,14V21H4V19H8V21H10V19H14V21H16V19H20V21H22V14M4,14H8V17H4V14M10,14H14V17H10V14M20,14V17H16V14H20M11,10H13V7H16V5H13V2H11V5H8V7H11V10Z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M9.41,13L12,15.59L14.59,13L16,14.41L13.41,17L16,19.59L14.59,21L12,18.41L9.41,21L8,19.59L10.59,17L8,14.41L9.41,13M22,9A2,2 0 0,1 20,11H4A2,2 0 0,1 2,9V6A2,2 0 0,1 4,4H20A2,2 0 0,1 22,6V9M4,9H8V6H4V9M10,9H14V6H10V9M16,9H20V6H16V9Z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M4,2H11A2,2 0 0,1 13,4V20A2,2 0 0,1 11,22H4A2,2 0 0,1 2,20V4A2,2 0 0,1 4,2M4,10V14H11V10H4M4,16V20H11V16H4M4,4V8H11V4H4M17.59,12L15,9.41L16.41,8L19,10.59L21.59,8L23,9.41L20.41,12L23,14.59L21.59,16L19,13.41L16.41,16L15,14.59L17.59,12Z"></path></svg>'},function(e,t,l){const{TableCore:s}=l(17),i={Toolbox:l(16),InsertColAfter:l(0),InsertRowAfter:l(1)};e.exports=class{static get enableLineBreaks(){return!0}static get toolbox(){return{icon:i.Toolbox,title:"Table"}}constructor({data:e,config:t,api:l}){this.api=l,this._table=new s(e,t,l),this.actions=[{actionName:"InsertColAfter",icon:i.InsertColAfter},{actionName:"InsertRowAfter",icon:i.InsertRowAfter}]}performAction(e){switch(e){case"InsertColAfter":return this._table.insertColumnAfter();case"InsertRowAfter":return this._table.insertRowAfter()}}renderSettings(){const e=document.createElement("div");return this.actions.forEach(({actionName:t,icon:l})=>{const s=document.createElement("div");s.classList.add("ce-settings__button"),s.innerHTML=l,s.title=t,s.addEventListener("click",this.performAction.bind(this,t)),e.appendChild(s)}),e}render(){return this._table.htmlContainer}save(e){return{content:this._table.getData()}}}},function(e,t,l){var s=l(12);"string"==typeof s&&(s=[[e.i,s,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};l(14)(s,i);s.locals&&(e.exports=s.locals)},function(e,t,l){(e.exports=l(13)(!1)).push([e.i,".tc-table{position:relative;width:100%;height:100%;border-collapse:collapse;table-layout:fixed;}.tc-table__wrap{border:1px solid #dbdbe2;border-radius:3px;position:relative;height:100%;width:100%;box-sizing:border-box}.tc-table__top-border{position:absolute;top:-20px;left:0;right:0;height:20px;}.tc-table__top-border:hover{cursor:s-resize}.tc-table__left-border{position:absolute;left:-20px;top:0;bottom:0;width:20px;}.tc-table__left-border:hover{cursor:e-resize}.tc-table__cell{position:relative;border:1px solid #dbdbe2;padding:0;vertical-align:top}.tc-table__area{padding:10px;height:100%}.tc-table__inp{outline:none;flex-grow:100;min-height:1.5em;height:100%;overflow:hidden}.tc-table__align-left{text-align:left}.tc-table__align-center{text-align:center}.tc-table__align-right{text-align:right}.tc-table__highlight{background-color:rgba(0,0,0,.1)}.tc-table__first-cell{background-color:rgba(0,0,0,.03);outline:1px solid rgba(0,0,0,.2)}.tc-table tbody tr:first-child td{border-top:none}.tc-table tbody tr:last-child td{border-bottom:none}.tc-table tbody tr td:last-child{border-right:none}.tc-table tbody tr td:first-child{border-left:none}.tc-table-tools__wrapper{position:absolute;display:flex;flex-wrap:wrap;max-width:144px;background-color:#fff;box-shadow:1px 1px 8px #ccc;padding:0 4px;transition:all .3s;opacity:0;}.tc-table-tools__wrapper--visible{opacity:1}.tc-table-tools__button{background:transparent;border:none;padding:4px 2px;margin:0 4px;transition:.2s;}.tc-table-tools__button:hover{background-color:hsla(0,0%,39.2%,.1);cursor:pointer}.tc-table-tools__button:focus{outline:none}",""])},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var l=function(e,t){var l=e[1]||"",s=e[3];if(!s)return l;if(t&&"function"==typeof btoa){var i=(n=s,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),r=s.sources.map(function(e){return"/*# sourceURL="+s.sourceRoot+e+" */"});return[l].concat(r).concat([i]).join("\n")}var n;return[l].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+l+"}":l}).join("")},t.i=function(e,l){"string"==typeof e&&(e=[[null,e,""]]);for(var s={},i=0;i<this.length;i++){var r=this[i][0];"number"==typeof r&&(s[r]=!0)}for(i=0;i<e.length;i++){var n=e[i];"number"==typeof n[0]&&s[n[0]]||(l&&!n[2]?n[2]=l:l&&(n[2]="("+n[2]+") and ("+l+")"),t.push(n))}},t}},function(e,t,l){var s,i,r={},n=(s=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=s.apply(this,arguments)),i}),o=function(e){var t={};return function(e,l){if("function"==typeof e)return e();if(void 0===t[e]){var s=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,l);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}}(),a=null,c=0,h=[],d=l(15);function f(e,t){for(var l=0;l<e.length;l++){var s=e[l],i=r[s.id];if(i){i.refs++;for(var n=0;n<i.parts.length;n++)i.parts[n](s.parts[n]);for(;n<s.parts.length;n++)i.parts.push(C(s.parts[n],t))}else{var o=[];for(n=0;n<s.parts.length;n++)o.push(C(s.parts[n],t));r[s.id]={id:s.id,refs:1,parts:o}}}}function u(e,t){for(var l=[],s={},i=0;i<e.length;i++){var r=e[i],n=t.base?r[0]+t.base:r[0],o={css:r[1],media:r[2],sourceMap:r[3]};s[n]?s[n].parts.push(o):l.push(s[n]={id:n,parts:[o]})}return l}function p(e,t){var l=o(e.insertInto);if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var s=h[h.length-1];if("top"===e.insertAt)s?s.nextSibling?l.insertBefore(t,s.nextSibling):l.appendChild(t):l.insertBefore(t,l.firstChild),h.push(t);else if("bottom"===e.insertAt)l.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=o(e.insertAt.before,l);l.insertBefore(t,i)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=h.indexOf(e);t>=0&&h.splice(t,1)}function b(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var s=function(){0;return l.nc}();s&&(e.attrs.nonce=s)}return _(t,e.attrs),p(e,t),t}function _(e,t){Object.keys(t).forEach(function(l){e.setAttribute(l,t[l])})}function C(e,t){var l,s,i,r;if(t.transform&&e.css){if(!(r="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=r}if(t.singleton){var n=c++;l=a||(a=b(t)),s=v.bind(null,l,n,!1),i=v.bind(null,l,n,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(l=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",_(t,e.attrs),p(e,t),t}(t),s=function(e,t,l){var s=l.css,i=l.sourceMap,r=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||r)&&(s=d(s));i&&(s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var n=new Blob([s],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(n),o&&URL.revokeObjectURL(o)}.bind(null,l,t),i=function(){g(l),l.href&&URL.revokeObjectURL(l.href)}):(l=b(t),s=function(e,t){var l=t.css,s=t.media;s&&e.setAttribute("media",s);if(e.styleSheet)e.styleSheet.cssText=l;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(l))}}.bind(null,l),i=function(){g(l)});return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=n()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var l=u(e,t);return f(l,t),function(e){for(var s=[],i=0;i<l.length;i++){var n=l[i];(o=r[n.id]).refs--,s.push(o)}e&&f(u(e,t),t);for(i=0;i<s.length;i++){var o;if(0===(o=s[i]).refs){for(var a=0;a<o.parts.length;a++)o.parts[a]();delete r[o.id]}}}};var w,m=(w=[],function(e,t){return w[e]=t,w.filter(Boolean).join("\n")});function v(e,t,l,s){var i=l?"":s.css;if(e.styleSheet)e.styleSheet.cssText=m(t,i);else{var r=document.createTextNode(i),n=e.childNodes;n[t]&&e.removeChild(n[t]),n.length?e.insertBefore(r,n[t]):e.appendChild(r)}}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var l=t.protocol+"//"+t.host,s=l+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var i,r=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?e:(i=0===r.indexOf("//")?r:0===r.indexOf("/")?l+r:s+r.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(e,t){e.exports='<svg width="18" height="14"><path d="M2.833 8v1.95a1.7 1.7 0 0 0 1.7 1.7h3.45V8h-5.15zm0-2h5.15V2.35h-3.45a1.7 1.7 0 0 0-1.7 1.7V6zm12.3 2h-5.15v3.65h3.45a1.7 1.7 0 0 0 1.7-1.7V8zm0-2V4.05a1.7 1.7 0 0 0-1.7-1.7h-3.45V6h5.15zM4.533.1h8.9a3.95 3.95 0 0 1 3.95 3.95v5.9a3.95 3.95 0 0 1-3.95 3.95h-8.9a3.95 3.95 0 0 1-3.95-3.95v-5.9A3.95 3.95 0 0 1 4.533.1z"></path></svg>'},function(e,t,l){"use strict";function s(e){return!(null==e)}function i(e,t=null,l=null,i=null){const r=document.createElement(e);if(s(t))for(let e=0;e<t.length;e++)s(t[e])&&r.classList.add(t[e]);if(s(l))for(let e in l)r.setAttribute(e,l[e]);if(s(i))for(let e=0;e<i.length;e++)s(i[e])&&r.appendChild(i[e]);return r}function r(e){if(!e)return;let t=0;for(;null!=(e=e.previousSibling);)++t;return t}l.r(t);l(11);var n=l(2),o=l.n(n),a=l(3),c=l.n(a),h=l(4),d=l.n(h),f=l(5),u=l.n(f),p=l(6),g=l.n(p),b=l(0),_=l.n(b),C=l(7),w=l.n(C),m=l(1),v=l.n(m),y=l(8),x=l.n(y),H=l(9),V=l.n(H);const S={clearCells:o.a,alignLeft:c.a,alignCenter:d.a,alignRight:u.a,insertColBefore:g.a,insertColAfter:_.a,insertRowBefore:w.a,insertRowAfter:v.a,deleteRow:x.a,deleteCol:V.a},L={wrapper:"tc-table-tools__wrapper",visible:"tc-table-tools__wrapper--visible",button:"tc-table-tools__button",icon:"tc-table-tools__icon"};class A{static getWrapperClass(){return L.wrapper}constructor(e,t,l,s){this._buttons=e,this._table=t,this._position=s;const i=this._createButtons(this._buttons);this._element=this._createToolsWrapper(i),this._table.body.appendChild(this._element),this._placeTools(l,this._position),setTimeout(()=>{this._showTools()},700)}get toolbarElement(){return this._element}_createToolsWrapper(e){return i("div",[L.wrapper],null,[...e])}_createButtons(e){let t=[];for(const l of e){const e=i("button",[L.button],{type:"button"},[i("div",[L.icon],{title:l})]);e.querySelector("."+L.icon).innerHTML=S[l],e.addEventListener("click",()=>{this._callAction(l)}),t.push(e)}return t}_placeTools(e,t){const l=e.offsetLeft+e.offsetWidth/2-100,s=e.offsetTop+e.offsetHeight/2,i={x:0,y:0};"top"===t&&(i.y=-e.offsetHeight-70),"bottom"===t&&(i.y=e.offsetHeight/2+10),this._element.style=`top: ${s+i.y}px; left: ${l+i.x}px`}_showTools(){this._element.classList.add(L.visible)}_callAction(e){switch(e){case"insertColBefore":return this._table.insertColumnBefore();case"insertColAfter":return this._table.insertColumnAfter();case"insertRowBefore":return this._table.insertRowBefore();case"insertRowAfter":return this._table.insertRowAfter();case"deleteRow":return this._table.deleteRow();case"deleteCol":return this._table.deleteColumn();case"clearCells":return this._table.clearCells();case"alignLeft":return this._table.toggleCellAlignment("left");case"alignCenter":return this._table.toggleCellAlignment("center");case"alignRight":return this._table.toggleCellAlignment("right")}}}l.d(t,"TableCore",function(){return B});const M={editor:"tc-editor",table:"tc-table",topBorder:"tc-table__top-border",leftBorder:"tc-table__left-border",inputField:"tc-table__inp",cell:"tc-table__cell",wrapper:"tc-table__wrap",area:"tc-table__area",highlight:"tc-table__highlight",firstCell:"tc-table__first-cell",alignLeft:"tc-table__align-left",alignCenter:"tc-table__align-center",alignRight:"tc-table__align-right"};class B{constructor(e,t,l){this.api=l,this._numberOfColumns=0,this._numberOfRows=0,this._element=this._createTableWrapper(),this._table=this._element.querySelector("table"),this._isSelectingCellsByBorder=!1,this._isSelectingCells=!1,this._selectedCells=[],this._selectedCellFrom=null,this._selectedCellTo=null,this._tableToolbar=null,this._isCellFocused=!1,this._isFocusChanged=!1,this._resizeTable(e,t),this._fillTable(e),this._container=i("div",[M.editor,l.styles&&l.styles.block],null,[this.htmlElement]),this._attachEvents()}get firstSelectedCell(){return this._selectedCellFrom}set firstSelectedCell(e){this._selectedCellFrom&&this._selectedCellFrom.classList.remove(M.firstCell),this._selectedCellFrom=e,this._selectedCellFrom&&this._selectedCellFrom.classList.add(M.firstCell)}get lastSelectedCell(){return this._selectedCellTo}set lastSelectedCell(e){if(this._tableToolbar&&(this._table.removeChild(this._tableToolbar),this._tableToolbar=null),this._selectedCellTo=e,this._selectedCellTo){const e=r(this.firstSelectedCell.parentNode)<=r(this._selectedCellTo.parentNode)?"bottom":"top",t=new A([...["clearCells","alignLeft","alignCenter","alignRight","insertColBefore","insertColAfter","insertRowBefore","insertRowAfter","deleteRow","deleteCol"]],this,this._selectedCellTo,e);this._tableToolbar=t.toolbarElement}}get selectedCells(){return this._selectedCells||[]}set selectedCells(e){const t=this._selectedCells.filter(t=>!e.includes(t)),l=e.filter(e=>!this._selectedCells.includes(e));this._unhighlightCells(t),this._highlightCells(l),this._selectedCells=e}get selectedRows(){const e=new Set;return this.selectedCells.length&&this.selectedCells.forEach(t=>e.add(t.closest("tr"))),Array.from(e)}get selectedColumns(){const e=new Set;return this.selectedCells.length&&this.selectedCells.forEach(t=>{const l=this._table.rows[0];e.add(l.cells[t.cellIndex])}),Array.from(e)}_resizeTable(e,t){const l=Array.isArray(e.content),s=!!l&&e.content.length,i=l?e.content.length:void 0,r=s?e.content[0].length:void 0,n=Number.parseInt(t.rows),o=Number.parseInt(t.cols),a=!isNaN(n)&&n>0?n:void 0,c=!isNaN(o)&&o>0?o:void 0,h=i||a||2,d=r||c||2;for(let e=0;e<h;e++)this.insertRow();for(let e=0;e<d;e++)this.insertColumn();return{rows:h,cols:d}}_fillTable(e){if(void 0!==e.content)for(let t=0;t<this._numberOfRows&&t<e.content.length;t++)for(let l=0;l<this._numberOfColumns&&l<e.content[t].length;l++){const s=this._table.rows[t].cells[l].querySelector("."+M.inputField),i=/(\#\{(?<prefix>[\w;=]*)\})?(?<value>[\w\W.]*)/,r=e.content[t][l],n=i.exec(r),o=n.groups.prefix;if(o){const e=o.split(";").filter(e=>e);for(const t of e){const[e,l]=t.split("=");"align"===e&&this._setInputAlignment(s,l)}}s.innerHTML=n.groups.value}}insertColumnAfter(){this.insertColumn(1)}insertColumnBefore(){this.insertColumn()}insertRowBefore(){this.insertRow()}insertRowAfter(){this.insertRow(1)}insertColumn(e=0){let t=e*this._numberOfColumns;if(this.firstSelectedCell&&this.lastSelectedCell){const l=r(this.firstSelectedCell),s=r(this.lastSelectedCell),i=l>s?l:s,n=l<s?l:s;t=e?i+1:n}const l=this.selectedColumns.length||1;for(let e=0;e<l;e++){const e=this._table.rows;for(let l=0;l<e.length;l++){const s=e[l].insertCell(t);this._fillCell(s)}this._numberOfColumns++}}deleteColumn(){this.selectedColumns.length&&(this.selectedColumns.forEach(e=>{const t=e.cellIndex,l=this._table.rows;for(let e=0;e<l.length;e++)l[e].deleteCell(t);this._numberOfColumns--}),this._resetSelecting())}insertRow(e=0){let t=e*this._numberOfRows;if(this.firstSelectedCell&&this.lastSelectedCell){const l=r(this.firstSelectedCell.parentNode),s=r(this.lastSelectedCell.parentNode),i=l>s?l:s,n=l<s?l:s;t=e?i+1:n}const l=this.selectedRows.length||1;for(let e=0;e<l;e++){const e=this._table.insertRow(t);this._numberOfRows++,this._fillRow(e)}}deleteRow(){this.selectedRows.length&&(this.selectedRows.forEach(e=>{this._table.deleteRow(e.rowIndex),this._numberOfRows--}),this._resetSelecting())}get htmlElement(){return this._element}get htmlContainer(){return this._container}get body(){return this._table}_createTableWrapper(){return i("div",[M.wrapper],null,[i("table",[M.table],null,[i("div",[M.topBorder]),i("div",[M.leftBorder])])])}_createContenteditableArea(){return i("div",[M.inputField],{contenteditable:"false",tabindex:"0"})}_fillCell(e){e.classList.add(M.cell);const t=this._createContenteditableArea();e.appendChild(i("div",[M.area],null,[t]))}_fillRow(e){for(let t=0;t<this._numberOfColumns;t++){const t=e.insertCell();this._fillCell(t)}}_attachEvents(){this._table.addEventListener("keydown",e=>{this._pressedEnterInEditField(e),this._selectCellsByKeyboard(e)}),this._table.addEventListener("mousedown",e=>{this._selectCellsByBorder(e),e.shiftKey?this._selectCellsByShift(e):e.ctrlKey||e.metaKey?this._selectCellsByCtrl(e):this._mousedownOnCell(e)}),this._table.addEventListener("click",e=>{this._clickOnCell(e)}),this._table.addEventListener("mousemove",e=>{this._selectCellsByBorder(e),this._handleMouseMove(e)}),this._table.addEventListener("mouseup",()=>{this._isSelectingCells=!1,this._isSelectingCellsByBorder=!1}),this.api.listeners.on(this._table,"blur",e=>{this._isFocusChanged=!1,setTimeout(()=>{this._isFocusChanged||this._resetSelecting()},0)},!0),this.api.listeners.on(this._table,"focus",e=>{this._isFocusChanged=!0},!0)}_startSelecting(e){this._isSelectingCells=!0,this.firstSelectedCell="TD"===e.target.tagName?e.target:e.target.closest("td"),this.lastSelectedCell=this.firstSelectedCell,this._selectCells()}_handleMouseMove(e){if(this._isSelectingCells&&1===e.buttons){const t="TD"===e.target.tagName?e.target:e.target.closest("td");this.lastSelectedCell!==t&&(this.lastSelectedCell=t,this._selectCells())}else this._isSelectingCells=!1}_selectCells(){if(!this.firstSelectedCell||!this.lastSelectedCell)return void this._resetSelecting();const e={x:r(this.firstSelectedCell),y:r(this.firstSelectedCell.parentNode)},t={x:r(this.lastSelectedCell),y:r(this.lastSelectedCell.parentNode)},l={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y)},s=Math.max(e.x,t.x),i=Math.max(e.y,t.y),n=[],o=this._table.querySelectorAll("tr");for(let e=l.y;e<=i;e++){const t=o[e].querySelectorAll("td");for(let e=l.x;e<=s;e++)n.push(t[e])}this.selectedCells=n}_selectCellsByShift(e){e.preventDefault();const t="TD"===e.target.tagName?e.target:e.target.closest("td");this.lastSelectedCell=t,this._selectCells()}_selectCellsByCtrl(e){e.preventDefault();const t="TD"===e.target.tagName?e.target:e.target.closest("td");this.selectedCells.includes(t)?(this.selectedCells=this.selectedCells.filter(e=>e!==t),this.firstSelectedCell===t&&(this.selectedCells.length?this.firstSelectedCell=this.selectedCells[0]:this._resetSelecting())):(this.selectedCells=[...this.selectedCells,t],this.firstSelectedCell||(this.firstSelectedCell=t))}_unhighlightCells(e){e.forEach(e=>e.classList.remove(M.highlight))}_highlightCells(e){e.forEach(e=>e.classList.add(M.highlight))}_resetSelecting(){this.firstSelectedCell=null,this.lastSelectedCell=null,this.selectedCells=[],this._isSelectingCells=!1,this._isFocusChanged=!1}_selectCellsByBorder(e){if(1!==e.buttons)return void(this._isSelectingCellsByBorder=!1);const t=e.target;if(t.classList.contains(M.topBorder)){this._isSelectingCellsByBorder||this._resetSelecting();let t=e.layerX,l=0;const s=this._table.rows[0];for(let e of s.cells){if((t-=e.offsetWidth)<=0){this._isSelectingCellsByBorder||(this.firstSelectedCell=e);break}l++}const i=this._table.rows[this._numberOfRows-1].cells[l];this.lastSelectedCell=i,this._isSelectingCellsByBorder=!0,this._selectCells()}if(t.classList.contains(M.leftBorder)){this._isSelectingCellsByBorder||this._resetSelecting();let t=e.layerY,l=0;for(let e of this._table.rows){const s=e.cells[0];if((t-=s.offsetHeight)<=0){this._isSelectingCellsByBorder||(this.firstSelectedCell=s);break}l++}const s=this._table.rows[l],i=s.cells[s.cells.length-1];this.lastSelectedCell=i,this._isSelectingCellsByBorder=!0,this._selectCells()}}_pressedEnterInEditField(e){e.target.classList.contains(M.inputField)&&("Enter"!==e.key||e.shiftKey||e.preventDefault())}_selectCellsByKeyboard(e){if(!this.firstSelectedCell)return;this.lastSelectedCell||(this.lastSelectedCell=this.firstSelectedCell);let t=!1;if(this._isCellFocused)"Escape"===e.key&&(t=!0,this._unfocusCell());else if("Enter"===e.key&&(t=!0,this._focusCell()),e.shiftKey){let l={...{x:r(this.lastSelectedCell),y:r(this.lastSelectedCell.parentNode)}};if(e.ctrlKey||e.metaKey){if("ArrowRight"===e.key&&(t=!0,l.x=this._numberOfColumns-1),"ArrowLeft"===e.key&&(t=!0,l.x=0),"ArrowUp"===e.key&&(t=!0,l.y=0),"ArrowDown"===e.key&&(t=!0,l.y=this._numberOfRows-1),t){const e=this._table.querySelectorAll("tr")[l.y].querySelectorAll("td")[l.x];this.lastSelectedCell=e,this._selectCells()}}else if("ArrowRight"===e.key&&(t=!0,l.x=Math.min(this._numberOfColumns-1,l.x+1)),"ArrowLeft"===e.key&&(t=!0,l.x=Math.max(0,l.x-1)),"ArrowUp"===e.key&&(t=!0,l.y=Math.max(0,l.y-1)),"ArrowDown"===e.key&&(t=!0,l.y=Math.min(this._numberOfRows-1,l.y+1)),t){const e=this._table.querySelectorAll("tr")[l.y].querySelectorAll("td")[l.x];this.lastSelectedCell=e,this._selectCells()}}else{let l={...{x:r(this.firstSelectedCell),y:r(this.firstSelectedCell.parentNode)}};if("ArrowRight"===e.key&&(t=!0,l.x=Math.min(this._numberOfColumns-1,l.x+1)),"ArrowLeft"===e.key&&(t=!0,l.x=Math.max(0,l.x-1)),"ArrowUp"===e.key&&(t=!0,l.y=Math.max(0,l.y-1)),"ArrowDown"===e.key&&(t=!0,l.y=Math.min(this._numberOfRows-1,l.y+1)),t){const e=this._table.querySelectorAll("tr")[l.y].querySelectorAll("td")[l.x];this.firstSelectedCell=e,this.lastSelectedCell=this.firstSelectedCell,this._selectCells()}}t&&(e.stopPropagation(),e.preventDefault())}_mousedownOnCell(e){if("TBODY"===e.target.tagName)return;const t=e.target.classList.contains(M.inputField)?e.target:e.target.querySelector("."+M.inputField);if(!t)return;const l=t.closest("td");l===this.firstSelectedCell?this._focusCell():(this._unfocusCell(),this.firstSelectedCell=l),this._startSelecting(e)}_clickOnCell(){("TD"===event.target.tagName?event.target:event.target.closest("td"))&&this._focusCell()}_focusCell(){const e=this.firstSelectedCell.querySelector("."+M.inputField);e.contentEditable=!0,e.focus(),this._isCellFocused=!0}_unfocusCell(){if(this.firstSelectedCell){this.firstSelectedCell.querySelector("."+M.inputField).contentEditable=!1,this._isCellFocused=!1}}_isEmpty(e){return!e.textContent.trim()}_setInputAlignment(e,t){const l={left:M.alignLeft,center:M.alignCenter,right:M.alignRight},s=l[t];s&&(s===l.left?(e.classList.remove(l.center),e.classList.remove(l.right)):e.classList.contains(s)||(e.classList.add(s),s===l.center&&e.classList.remove(l.right),s===l.right&&e.classList.remove(l.center)))}getData(){const e=[],t=this._table.rows;for(let l=0;l<t.length;l++){const s=t[l],i=[];for(const e of s.cells)i.push(e.querySelector("."+M.inputField));if(i.every(this._isEmpty))continue;const r=i.map(e=>{let t="";return e.classList.contains(M.alignCenter)?t+="align=center;":e.classList.contains(M.alignRight)&&(t+="align=right;"),`#{${t}}${e.innerHTML}`});e.push(r)}return e}toggleCellAlignment(e){const t={left:M.alignLeft,center:M.alignCenter,right:M.alignRight}[e];if(!t)return;const l=this.selectedCells;let s=!1;for(const e of l){if(!(s=e.querySelector("."+M.inputField).classList.contains(t)))break}for(const i of l){const l=i.querySelector("."+M.inputField);s?l.classList.remove(t):this._setInputAlignment(l,e)}}clearCells(){const e=[M.alignLeft,M.alignCenter,M.alignRight],t=this.selectedCells;for(const l of t){const t=l.querySelector("."+M.inputField);for(const l of e)t.classList.remove(l);t.innerHtml="",t.innerText=""}}}}])});